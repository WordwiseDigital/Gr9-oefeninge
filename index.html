import React, { useState, useEffect } from 'react';
import { ChevronRight, ChevronLeft, BookOpen, CheckCircle, XCircle, RotateCcw, Award, Edit3, Brain, RefreshCw, Eye, EyeOff } from 'lucide-react';

const AfrikaansPracticeApp = () => {
  const [currentPaper, setCurrentPaper] = useState(0);
  const [currentQuestion, setCurrentQuestion] = useState(0);
  const [userAnswers, setUserAnswers] = useState({});
  const [showResults, setShowResults] = useState(false);
  const [score, setScore] = useState(0);
  const [currentView, setCurrentView] = useState('papers'); // 'papers' or 'flashcards'
  const [currentFlashcard, setCurrentFlashcard] = useState(0);
  const [showAnswer, setShowAnswer] = useState(false);
  const [shuffledCards, setShuffledCards] = useState([]);

  // 50 difficult Afrikaans vocabulary words from the texts
  const vocabularyCards = [
    { afrikaans: "wonderlike", english: "wonderful" },
    { afrikaans: "eienskappe", english: "characteristics/properties" },
    { afrikaans: "oorleef", english: "survive" },
    { afrikaans: "roofdier", english: "predator" },
    { afrikaans: "troppe", english: "herds/prides" },
    { afrikaans: "beskerm", english: "protect" },
    { afrikaans: "uitstekende", english: "excellent" },
    { afrikaans: "swemmers", english: "swimmers" },
    { afrikaans: "kolibrie", english: "hummingbird" },
    { afrikaans: "agteruit", english: "backwards" },
    { afrikaans: "landdiere", english: "land animals" },
    { afrikaans: "geheues", english: "memories" },
    { afrikaans: "herken", english: "recognize" },
    { afrikaans: "spiere", english: "muscles" },
    { afrikaans: "groet", english: "greet" },
    { afrikaans: "invloed", english: "influence" },
    { afrikaans: "platforms", english: "platforms" },
    { afrikaans: "roetine", english: "routine" },
    { afrikaans: "voordele", english: "advantages/benefits" },
    { afrikaans: "negatiewe", english: "negative" },
    { afrikaans: "gevolge", english: "consequences" },
    { afrikaans: "vergelyk", english: "compare" },
    { afrikaans: "selfbeeld", english: "self-image" },
    { afrikaans: "angs", english: "anxiety" },
    { afrikaans: "navorsers", english: "researchers" },
    { afrikaans: "spandeer", english: "spend" },
    { afrikaans: "depressief", english: "depressed" },
    { afrikaans: "kreatief", english: "creative" },
    { afrikaans: "gemeenskappe", english: "communities" },
    { afrikaans: "belangstellings", english: "interests" },
    { afrikaans: "onderwysers", english: "teachers" },
    { afrikaans: "gesonde", english: "healthy" },
    { afrikaans: "beperk", english: "limit" },
    { afrikaans: "vaardighede", english: "skills" },
    { afrikaans: "verhoudings", english: "relationships" },
    { afrikaans: "akademies", english: "academically" },
    { afrikaans: "respek", english: "respect" },
    { afrikaans: "begrip", english: "understanding" },
    { afrikaans: "konflik", english: "conflict" },
    { afrikaans: "voorkom", english: "prevent" },
    { afrikaans: "vriendskap", english: "friendship" },
    { afrikaans: "empatie", english: "empathy" },
    { afrikaans: "skoene", english: "shoes" },
    { afrikaans: "troos", english: "comfort/console" },
    { afrikaans: "samewerking", english: "cooperation" },
    { afrikaans: "noodsaaklik", english: "essential" },
    { afrikaans: "kompromieë", english: "compromises" },
    { afrikaans: "voltooi", english: "complete" },
    { afrikaans: "selfvertroue", english: "self-confidence" },
    { afrikaans: "leierskap", english: "leadership" }
  ];

  useEffect(() => {
    // Shuffle flashcards when component mounts
    setShuffledCards([...vocabularyCards].sort(() => Math.random() - 0.5));
  }, []);

  const shuffleCards = () => {
    setShuffledCards([...vocabularyCards].sort(() => Math.random() - 0.5));
    setCurrentFlashcard(0);
    setShowAnswer(false);
  };

  // Expanded practice papers with more questions and different types
  const practicePapers = [
    {
      id: 1,
      title: "Vraestel 1: Die Natuur",
      totalMarks: 40,
      comprehension: {
        title: "Die Wonderlike Wêreld van Diere",
        text: `Diere is wonderlike wesens wat ons planeet deel. Hulle kom in alle vorms en groottes voor - van die kleinste mier tot die grootste olifant. Elke dier het sy eie besondere eienskappe wat hom help om te oorleef.

Die leeu is bekend as die koning van die diere. Hy is 'n sterk roofdier wat in groepe, genoem troppe, leef. Die leeuwyfie is gewoonlik die een wat jag, terwyl die mannetjie sy gesin beskerm. Leeus kan tot 50 kilometer per uur hardloop wanneer hulle prooi jaag.

Voëls kan vlieg omdat hulle ligte bene en vere het. Sommige voëls, soos die arend, kan baie hoog vlieg en van ver af prooi sien. Ander voëls, soos pikkewyne, kan nie vlieg nie, maar hulle is uitstekende swemmers. Die kolibrie is die kleinste voël ter wêreld en kan selfs agteruit vlieg!

Olifante is die grootste landdiere. Hulle het uitstekende geheues en kan mekaar se stemme van kilometers ver herken. 'n Olifant se slurp het meer as 40,000 spiere en word gebruik om te eet, te drink en om mekaar te groet.`,
        questions: [
          {
            question: "Volgens die teks, wat maak die leeuwyfie gewoonlik?",
            options: ["Sy beskerm die gesin", "Sy jag", "Sy sorg vir die kleintjies", "Sy slaap"],
            correct: 1,
            type: "mcq",
            marks: 2
          },
          {
            question: "Hoe vinnig kan leeue hardloop?",
            type: "short_answer",
            correct: ["50 kilometer per uur", "50km/h", "50 km per uur", "vyftig kilometer per uur"],
            marks: 2
          },
          {
            question: "Noem TWEE redes waarom voëls kan vlieg.",
            type: "list",
            correct: ["ligte bene", "vere"],
            marks: 4,
            acceptAlternatives: [["ligte bene", "ligte vere"], ["vere", "ligte bene"]]
          },
          {
            question: "Verduidelik die verskil tussen arende en pikkewyne soos beskryf in die teks.",
            type: "paragraph",
            marks: 4,
            sampleAnswer: "Arende kan vlieg en hoog vlieg om prooi van ver af te sien, terwyl pikkewyne nie kan vlieg nie maar uitstekende swemmers is."
          },
          {
            question: "Hoeveel spiere het 'n olifant se slurp?",
            options: ["Meer as 30,000", "Meer as 40,000", "Meer as 50,000", "Meer as 60,000"],
            correct: 1,
            type: "mcq",
            marks: 2
          }
        ]
      },
      grammar: [
        {
          question: "Identifiseer die selfstandige naamwoord in: 'Die kat klim in die boom.'",
          options: ["Die", "kat, boom", "klim", "in"],
          correct: 1,
          topic: "Woordsoorte - Selfstandige naamwoorde",
          type: "mcq",
          marks: 2
        },
        {
          question: "Skryf die verlede tyd van hierdie werkwoorde:\na) loop\nb) eet\nc) sê",
          type: "fill_in",
          correct: ["geloop", "geëet", "gesê"],
          topic: "Werkwoordtyd en -vorm",
          marks: 6
        },
        {
          question: "Herstel die STOMPI-volgorde: 'gister / ek / na die winkel / het gegaan'",
          type: "short_answer",
          correct: ["Gister het ek na die winkel gegaan"],
          topic: "Sinbou & woordorde - STOMPI",
          marks: 3
        },
        {
          question: "Skryf die verkleiningsvorm van:\na) hond\nb) tafel\nc) boom",
          type: "fill_in",
          correct: ["hondjie", "tafeltjie", "boompie"],
          topic: "Woordvorming - Verkleinings",
          marks: 6
        },
        {
          question: "Kies die sinoniem vir 'groot':",
          options: ["klein", "reusagtig", "mooi", "vinnig"],
          correct: 1,
          topic: "Woordbetekenis - Sinonieme",
          type: "mcq",
          marks: 1
        },
        {
          question: "Verander na die lydende vorm: 'Die hond byte die man.'",
          type: "short_answer",
          correct: ["Die man word deur die hond gebyt"],
          topic: "Werkwoordtyd en -vorm - Lydende vorm",
          marks: 3
        },
        {
          question: "Skryf die meervoud van:\na) boek\nb) kind\nc) vrou",
          type: "fill_in",
          correct: ["boeke", "kinders", "vroue"],
          topic: "Woordvorming - Meervoude",
          marks: 6
        }
      ]
    },
    {
      id: 2,
      title: "Vraestel 2: Sosiale Media",
      totalMarks: 40,
      comprehension: {
        title: "Die Uitwerking van Sosiale Media op Tieners",
        text: `Sosiale media het 'n groot invloed op die lewens van tieners vandag. Platforms soos Instagram, TikTok en Snapchat is deel van hulle daaglikse roetine geword. Terwyl sosiale media baie voordele bied, soos om met vriende kontak te hou en nuwe dinge te leer, het dit ook negatiewe gevolge.

Baie tieners voel druk om perfek te lyk op sosiale media. Hulle vergelyk hulself met ander en voel soms nie goed genoeg nie. Hierdie vergelyking kan lei tot lae selfbeeld en angs. Navorsers het gevind dat tieners wat meer as drie uur per dag op sosiale media spandeer, 'n groter kans het om depressief te voel.

Aan die positiewe kant help sosiale media tieners om kreatief te wees. Hulle kan hulle kuns, musiek en idees met die wêreld deel. Dit help ook om gemeenskappe te vorm waar mense met dieselfde belangstellings mekaar kan ontmoet.

Ouers en onderwysers moet tieners help om sosiale media op 'n gesonde manier te gebruik. Dit beteken om tyd daarop te beperk en nie alles wat jy sien te glo nie. Tieners moet onthou dat mense gewoonlik net die beste dele van hulle lewens op sosiale media wys.`,
        questions: [
          {
            question: "Noem DRIE sosiale media platforms wat in die teks genoem word.",
            type: "list",
            correct: ["Instagram", "TikTok", "Snapchat"],
            marks: 6
          },
          {
            question: "Wat gebeur met tieners wat meer as drie uur per dag op sosiale media spandeer?",
            type: "short_answer",
            correct: ["Hulle het 'n groter kans om depressief te voel", "groter kans om depressief te voel"],
            marks: 3
          },
          {
            question: "Waarom voel baie tieners druk op sosiale media?",
            options: ["Hulle wil gewild wees", "Hulle voel druk om perfek te lyk", "Hulle het nie genoeg vriende nie", "Hulle verstaan nie die tegnologie nie"],
            correct: 1,
            type: "mcq",
            marks: 2
          },
          {
            question: "Verduidelik hoe sosiale media tieners help om kreatief te wees.",
            type: "paragraph",
            marks: 4,
            sampleAnswer: "Sosiale media help tieners om kreatief te wees deur hulle die geleentheid te gee om hulle kuns, musiek en idees met die wêreld te deel."
          },
          {
            question: "Wat moet tieners onthou oor wat mense op sosiale media post?",
            type: "short_answer",
            correct: ["Mense wys gewoonlik net die beste dele van hulle lewens", "mense wys net die beste dele"],
            marks: 3
          }
        ]
      },
      grammar: [
        {
          question: "Identifiseer die voornaamwoord in: 'Sy gaan môre na die partytjie.'",
          options: ["Sy", "gaan", "môre", "partytjie"],
          correct: 0,
          topic: "Woordsoorte - Voornaamwoorde",
          type: "mcq",
          marks: 2
        },
        {
          question: "Skryf in die toekomende tyd:\na) Ek eet 'n appel\nb) Hulle speel sokker\nc) Sy sing mooi",
          type: "fill_in",
          correct: ["Ek sal 'n appel eet", "Hulle sal sokker speel", "Sy sal mooi sing"],
          topic: "Werkwoordtyd en -vorm",
          marks: 6
        },
        {
          question: "Verander na 'n vraag: 'Jy verstaan die les.'",
          type: "short_answer",
          correct: ["Verstaan jy die les?"],
          topic: "Sinbou - Vraagvorme",
          marks: 2
        },
        {
          question: "Kies die korrekte trappe van vergelyking vir 'mooi':",
          options: ["mooi, mooier, mooiste", "mooi, mooiste, mooier", "mooier, mooi, mooiste", "mooiste, mooier, mooi"],
          correct: 0,
          topic: "Woordvorming - Trappe van vergelyking",
          type: "mcq",
          marks: 2
        },
        {
          question: "Verbeter die fout in hierdie sin: 'Die kinders is lief vir hulle ouers.'",
          type: "short_answer",
          correct: ["Die kinders is lief vir hul ouers", "hul in plaas van hulle"],
          topic: "Redigering in konteks",
          marks: 3
        },
        {
          question: "Skryf die teenoorgestelde (antoniem) van:\na) vroeg\nb) warm\nc) lig",
          type: "fill_in",
          correct: ["laat", "koud", "donker"],
          topic: "Woordbetekenis - Antonieme",
          marks: 6
        }
      ]
    },
    {
      id: 3,
      title: "Vraestel 3: Sosiale Vaardighede",
      totalMarks: 40,
      comprehension: {
        title: "Sosiale Vaardighede op Skool",
        text: `Sosiale vaardighede is baie belangrik vir sukses op skool en in die lewe. Hierdie vaardighede help leerders om goeie verhoudings met hulle maats en onderwysers te bou. Leerders wat goeie sosiale vaardighede het, is gewoonlik gelukkiger en presteer beter akademies.

Een van die belangrikste sosiale vaardighede is om goed te kan luister. Wanneer jy werklik luister na wat ander sê, wys jy respek en begrip. Dit help om konflik te voorkom en sterker vriendskap te bou. Baie leerders maak die fout om net te wag vir hulle beurt om te praat, in plaas daarvan om regtig te luister.

Empatie is nog 'n belangrike vaardigheid. Dit beteken om jouself in iemand anders se skoene te plaas en te probeer verstaan hoe hulle voel. Wanneer 'n maat hartseer is, kan empatie jou help om die regte woorde te vind om hulle te troos.

Samewerking is ook noodsaaklik op skool. Leerders moet leer om in groepe te werk, idees te deel en kompromieë te maak. Diegene wat goed kan saamwerk, vind dit makliker om projekte te voltooi en het gewoonlik meer vriende.

Laastens is selfvertroue belangrik. Leerders wat in hulself glo, is meer geneig om nuwe dinge te probeer en leierskap te toon. Hulle is ook minder bang om foute te maak, wat 'n natuurlike deel van leer is.`,
        questions: [
          {
            question: "Volgens die teks, wat is een van die belangrikste sosiale vaardighede?",
            options: ["Om baie te praat", "Om goed te kan luister", "Om hard te studeer", "Om populêr te wees"],
            correct: 1,
            type: "mcq",
            marks: 2
          },
          {
            question: "Wat beteken empatie volgens die teks?",
            type: "paragraph",
            marks: 4,
            sampleAnswer: "Empatie beteken om jouself in iemand anders se skoene te plaas en te probeer verstaan hoe hulle voel."
          },
          {
            question: "Noem VIER sosiale vaardighede wat in die teks bespreek word.",
            type: "list",
            correct: ["luister", "empatie", "samewerking", "selfvertroue"],
            marks: 8,
            acceptAlternatives: [["goed luister", "empatie", "samewerking", "selfvertroue"]]
          },
          {
            question: "Waarom is samewerking noodsaaklik op skool?",
            type: "short_answer",
            correct: ["Om in groepe te werk, idees te deel en kompromieë te maak", "vir groepwerk en om idees te deel"],
            marks: 3
          },
          {
            question: "Wat maak leerders met selfvertroue anders as diegene sonder selfvertroue?",
            type: "short_answer", 
            correct: ["Hulle is meer geneig om nuwe dinge te probeer en leierskap te toon", "hulle probeer nuwe dinge en wys leierskap"],
            marks: 3
          }
        ]
      },
      grammar: [
        {
          question: "Identifiseer die bywoord in: 'Sy hardloop vinnig na die huis.'",
          options: ["Sy", "hardloop", "vinnig", "huis"],
          correct: 2,
          topic: "Woordsoorte - Bywoorde",
          type: "mcq",
          marks: 2
        },
        {
          question: "Skryf hierdie sinne in die lydende vorm:\na) Die onderwyser gee die toets\nb) Ons eet die kos",
          type: "fill_in",
          correct: ["Die toets word deur die onderwyser gegee", "Die kos word deur ons geëet"],
          topic: "Werkwoordtyd en -vorm - Lydende vorm",
          marks: 6
        },
        {
          question: "Voeg die korrekte lidwoord by: '__ man loop in __ tuin.'",
          type: "fill_in",
          correct: ["Die", "die"],
          topic: "Woordsoorte - Lidwoorde",
          marks: 4
        },
        {
          question: "Herstel die woordorde (STOMPI): 'vandag / ons / vroeg / het / opgestaan'",
          type: "short_answer",
          correct: ["Ons het vandag vroeg opgestaan"],
          topic: "Sinbou & woordorde - STOMPI",
          marks: 3
        },
        {
          question: "Kies die korrekte voegwoord: 'Ek studeer hard __ ek wil slaag.'",
          options: ["maar", "want", "of", "en"],
          correct: 1,
          topic: "Woordsoorte - Voegwoorde",
          type: "mcq",
          marks: 2
        },
        {
          question: "Skryf 'n sin met die idioom 'die kat uit die sak laat'.",
          type: "paragraph",
          marks: 3,
          sampleAnswer: "Sy het die kat uit die sak gelaat toe sy die verrassing verklap het.",
          topic: "Woordbetekenis - Idiome"
        }
      ]
    }
  ];

  const allQuestions = () => {
    const paper = practicePapers[currentPaper];
    return [...paper.comprehension.questions, ...paper.grammar];
  };

  const handleAnswerSelect = (questionIndex, answerIndex) => {
    setUserAnswers({
      ...userAnswers,
      [questionIndex]: answerIndex
    });
  };

  const handleTextAnswer = (questionIndex, answer) => {
    setUserAnswers({
      ...userAnswers,
      [questionIndex]: answer
    });
  };

  const checkAnswer = (question, userAnswer, questionIndex) => {
    if (question.type === 'mcq') {
      return userAnswer === question.correct;
    } else if (question.type === 'short_answer') {
      if (Array.isArray(question.correct)) {
        return question.correct.some(correct => 
          userAnswer?.toLowerCase().trim().includes(correct.toLowerCase()) ||
          correct.toLowerCase().includes(userAnswer?.toLowerCase().trim())
        );
      }
      return userAnswer?.toLowerCase().trim() === question.correct?.toLowerCase().trim();
    } else if (question.type === 'fill_in') {
      if (Array.isArray(question.correct) && Array.isArray(userAnswer)) {
        return userAnswer.every((ans, idx) => 
          ans?.toLowerCase().trim() === question.correct[idx]?.toLowerCase().trim()
        );
      }
      return false;
    } else if (question.type === 'list') {
      if (Array.isArray(userAnswer) && Array.isArray(question.correct)) {
        const userLower = userAnswer.map(a => a?.toLowerCase().trim()).filter(Boolean);
        const correctLower = question.correct.map(c => c.toLowerCase().trim());
        
        // Check exact match first
        if (userLower.length === correctLower.length && 
            userLower.every(ans => correctLower.includes(ans))) {
          return true;
        }
        
        // Check alternatives if available
        if (question.acceptAlternatives) {
          return question.acceptAlternatives.some(alt => 
            alt.every(correct => userLower.includes(correct.toLowerCase().trim()))
          );
        }
        
        return false;
      }
      return false;
    } else if (question.type === 'paragraph') {
      // For paragraph answers, we'll be lenient and give partial credit
      return userAnswer && userAnswer.trim().length > 10;
    }
    return false;
  };

  const calculateScore = () => {
    const questions = allQuestions();
    let totalMarks = 0;
    questions.forEach((q, index) => {
      if (checkAnswer(q, userAnswers[index], index)) {
        totalMarks += q.marks || 1;
      }
    });
    setScore(totalMarks);
    return totalMarks;
  };

  const getTotalPossibleMarks = () => {
    return allQuestions().reduce((total, q) => total + (q.marks || 1), 0);
  };

  const handleSubmit = () => {
    calculateScore();
    setShowResults(true);
  };

  const resetPaper = () => {
    setCurrentQuestion(0);
    setUserAnswers({});
    setShowResults(false);
    setScore(0);
  };

  const nextQuestion = () => {
    if (currentQuestion < allQuestions().length - 1) {
      setCurrentQuestion(currentQuestion + 1);
    }
  };

  const prevQuestion = () => {
    if (currentQuestion > 0) {
      setCurrentQuestion(currentQuestion - 1);
    }
  };

  const renderQuestionInput = (question, questionIndex) => {
    const userAnswer = userAnswers[questionIndex];
    
    if (question.type === 'mcq') {
      return (
        <div className="space-y-3">
          {question.options.map((option, index) => (
            <button
              key={index}
              onClick={() => handleAnswerSelect(questionIndex, index)}
              className={`w-full p-4 text-left rounded-lg border-2 transition-all ${
                userAnswer === index
                  ? 'border-blue-500 bg-blue-50 text-blue-800'
                  : 'border-gray-200 hover:border-gray-300 hover:bg-gray-50'
              }`}
            >
              <span className="font-medium mr-3">{String.fromCharCode(65 + index)}.</span>
              {option}
            </button>
          ))}
        </div>
      );
    } else if (question.type === 'short_answer') {
      return (
        <textarea
          className="w-full p-3 border-2 border-gray-200 rounded-lg focus:border-blue-500 focus:outline-none"
          rows="2"
          placeholder="Skryf jou antwoord hier..."
          value={userAnswer || ''}
          onChange={(e) => handleTextAnswer(questionIndex, e.target.value)}
        />
      );
    } else if (question.type === 'paragraph') {
      return (
        <textarea
          className="w-full p-3 border-2 border-gray-200 rounded-lg focus:border-blue-500 focus:outline-none"
          rows="4"
          placeholder="Skryf 'n volledige antwoord..."
          value={userAnswer || ''}
          onChange={(e) => handleTextAnswer(questionIndex, e.target.value)}
        />
      );
    } else if (question.type === 'fill_in') {
      return (
        <div className="space-y-3">
          {question.correct.map((_, index) => (
            <div key={index}>
              <label className="block text-sm font-medium text-gray-700 mb-1">
                {String.fromCharCode(97 + index)})
              </label>
              <input
                type="text"
                className="w-full p-2 border-2 border-gray-200 rounded-lg focus:border-blue-500 focus:outline-none"
                placeholder="Vul in..."
                value={userAnswer?.[index] || ''}
                onChange={(e) => {
                  const newAnswers = [...(userAnswer || [])];
                  newAnswers[index] = e.target.value;
                  handleTextAnswer(questionIndex, newAnswers);
                }}
              />
            </div>
          ))}
        </div>
      );
    } else if (question.type === 'list') {
      return (
        <div className="space-y-3">
          {[...Array(question.correct.length)].map((_, index) => (
            <div key={index}>
              <label className="block text-sm font-medium text-gray-700 mb-1">
                {index + 1}.
              </label>
              <input
                type="text"
                className="w-full p-2 border-2 border-gray-200 rounded-lg focus:border-blue-500 focus:outline-none"
                placeholder="Tik antwoord..."
                value={userAnswer?.[index] || ''}
                onChange={(e) => {
                  const newAnswers = [...(userAnswer || [])];
                  newAnswers[index] = e.target.value;
                  handleTextAnswer(questionIndex, newAnswers);
                }}
              />
            </div>
          ))}
        </div>
      );
    }
  };

  const questions = allQuestions();
  const currentQ = questions[currentQuestion];
  const paper = practicePapers[currentPaper];
  const totalPossibleMarks = getTotalPossibleMarks();
  const currentCard = shuffledCards[currentFlashcard] || vocabularyCards[0];

  // Flashcard View
  if (currentView === 'flashcards') {
    return (
      <div className="max-w-4xl mx-auto p-6 bg-gradient-to-br from-purple-50 to-pink-50 min-h-screen">
        <div className="bg-white rounded-lg shadow-lg p-6">
          {/* Header */}
          <div className="mb-6">
            <div className="flex items-center justify-between mb-4">
              <div className="flex items-center">
                <Brain className="h-8 w-8 text-purple-600 mr-3" />
                <div>
                  <h1 className="text-2xl font-bold text-gray-800">Woordeskat Flitskaarte</h1>
                  <p className="text-gray-600">50 Moeilike Afrikaanse Woorde</p>
                </div>
              </div>
              <button
                onClick={() => setCurrentView('papers')}
                className="flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors"
              >
                <BookOpen className="h-5 w-5 mr-2" />
                Terug na Vraestelle
              </button>
            </div>
            
            <div className="flex justify-between items-center">
              <div className="text-sm text-gray-600">
                Kaart {currentFlashcard + 1} van {shuffledCards.length}
              </div>
              <button
                onClick={shuffleCards}
                className="flex items-center px-3 py-1 bg-purple-100 text-purple-700 rounded-lg hover:bg-purple-200 transition-colors text-sm"
              >
                <RefreshCw className="h-4 w-4 mr-1" />
                Meng Kaarte
              </button>
            </div>
            
            <div className="w-full bg-gray-200 rounded-full h-2 mt-3">
              <div
                className="bg-purple-600 h-2 rounded-full transition-all duration-300"
                style={{ width: `${((currentFlashcard + 1) / shuffledCards.length) * 100}%` }}
              ></div>
            </div>
          </div>

          {/* Flashcard */}
          <div className="flex justify-center mb-8">
            <div 
              className="relative w-80 h-48 bg-gradient-to-br from-purple-400 to-pink-400 rounded-xl shadow-lg cursor-pointer transform transition-transform hover:scale-105"
              onClick={() => setShowAnswer(!showAnswer)}
            >
              <div className="absolute inset-0 flex items-center justify-center text-white">
                <div className="text-center">
                  {!showAnswer ? (
                    <>
                      <div className="text-3xl font-bold mb-2">{currentCard.afrikaans}</div>
                      <div className="text-sm opacity-80 flex items-center justify-center">
                        <Eye className="h-4 w-4 mr-1" />
                        Kliek om antwoord te sien
                      </div>
                    </>
                  ) : (
                    <>
                      <div className="text-2xl font-bold mb-2">{currentCard.english}</div>
                      <div className="text-sm opacity-80 mb-2">English meaning</div>
                      <div className="text-sm opacity-70 flex items-center justify-center">
                        <EyeOff className="h-4 w-4 mr-1" />
                        Kliek om te versteek
                      </div>
                    </>
                  )}
                </div>
              </div>
              
              {/* Flip indicator */}
              <div className="absolute top-4 right-4">
                <div className="w-8 h-8 bg-white bg-opacity-20 rounded-full flex items-center justify-center">
                  <RefreshCw className="h-4 w-4 text-white" />
                </div>
              </div>
            </div>
          </div>

          {/* Controls */}
          <div className="flex justify-between items-center">
            <button
              onClick={() => {
                if (currentFlashcard > 0) {
                  setCurrentFlashcard(currentFlashcard - 1);
                  setShowAnswer(false);
                }
              }}
              disabled={currentFlashcard === 0}
              className={`flex items-center px-4 py-2 rounded-lg transition-colors ${
                currentFlashcard === 0
                  ? 'bg-gray-200 text-gray-400 cursor-not-allowed'
                  : 'bg-gray-300 text-gray-700 hover:bg-gray-400'
              }`}
            >
              <ChevronLeft className="h-5 w-5 mr-1" />
              Vorige
            </button>

            <div className="flex space-x-2">
              <button
                onClick={() => setShowAnswer(!showAnswer)}
                className="px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors"
              >
                {showAnswer ? 'Versteek' : 'Wys'} Antwoord
              </button>
            </div>

            <button
              onClick={() => {
                if (currentFlashcard < shuffledCards.length - 1) {
                  setCurrentFlashcard(currentFlashcard + 1);
                  setShowAnswer(false);
                } else {
                  // Reset to beginning
                  setCurrentFlashcard(0);
                  setShowAnswer(false);
                }
              }}
              className="flex items-center px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors"
            >
              {currentFlashcard === shuffledCards.length - 1 ? 'Begin Weer' : 'Volgende'}
              <ChevronRight className="h-5 w-5 ml-1" />
            </button>
          </div>

          {/* Progress stats */}
          <div className="mt-8 grid grid-cols-2 gap-4">
            <div className="bg-purple-50 rounded-lg p-4 text-center">
              <div className="text-2xl font-bold text-purple-600">{currentFlashcard + 1}</div>
              <div className="text-sm text-purple-800">Huidige Kaart</div>
            </div>
            <div className="bg-pink-50 rounded-lg p-4 text-center">
              <div className="text-2xl font-bold text-pink-600">{shuffledCards.length}</div>
              <div className="text-sm text-pink-800">Totale Kaarte</div>
            </div>
          </div>
        </div>
      </div>
    );
  }

  if (showResults) {
    const percentage = Math.round((score / totalPossibleMarks) * 100);
    
    return (
      <div className="max-w-4xl mx-auto p-6 bg-gradient-to-br from-blue-50 to-green-50 min-h-screen">
        <div className="bg-white rounded-lg shadow-lg p-8">
          <div className="text-center mb-6">
            <Award className="h-16 w-16 mx-auto mb-4 text-yellow-500" />
            <h2 className="text-3xl font-bold text-gray-800 mb-2">Uitslag</h2>
            <div className="text-6xl font-bold text-blue-600 mb-2">
              {percentage}%
            </div>
            <p className="text-xl text-gray-600">
              {score} uit {totalPossibleMarks} punte
            </p>
            <div className="mt-4 p-4 bg-blue-50 rounded-lg">
              <p className="text-lg font-semibold text-blue-800">
                {percentage >= 80 ? '🌟 Uitstekend!' : 
                 percentage >= 70 ? '👍 Goed gedaan!' :
                 percentage >= 60 ? '👌 Nie sleg nie!' :
                 percentage >= 50 ? '💪 Hou aan oefen!' : '📚 Meer oefening nodig!'}
              </p>
            </div>
          </div>

          <div className="space-y-4 mb-8 max-h-96 overflow-y-auto">
            {questions.map((q, index) => {
              const isCorrect = checkAnswer(q, userAnswers[index], index);
              return (
                <div key={index} className="border rounded-lg p-4">
                  <div className="flex items-start justify-between mb-2">
                    <div className="flex-1">
                      <p className="font-medium text-gray-800">{q.question}</p>
                      {q.topic && (
                        <p className="text-sm text-blue-600 mt-1">Onderwerp: {q.topic}</p>
                      )}
                    </div>
                    <div className="ml-2 flex items-center space-x-2">
                      <span className="text-sm font-medium text-gray-600">
                        {isCorrect ? q.marks : 0}/{q.marks}
                      </span>
                      {isCorrect ? (
                        <CheckCircle className="h-6 w-6 text-green-500" />
                      ) : (
                        <XCircle className="h-6 w-6 text-red-500" />
                      )}
                    </div>
                  </div>
                  
                  {q.type === 'mcq' && (
                    <div className="grid grid-cols-1 gap-2 mt-3">
                      {q.options.map((option, optIndex) => (
                        <div
                          key={optIndex}
                          className={`p-2 rounded text-sm ${
                            optIndex === q.correct
                              ? 'bg-green-100 text-green-800 border border-green-300'
                              : userAnswers[index] === optIndex
                              ? 'bg-red-100 text-red-800 border border-red-300'
                              : 'bg-gray-50 text-gray-700'
                          }`}
                        >
                          {option} {optIndex === q.correct && '✓'} 
                          {userAnswers[index] === optIndex && optIndex !== q.correct && '✗'}
                        </div>
                      ))}
                    </div>
                  )}
                  
                  {q.type !== 'mcq' && (
                    <div className="mt-3 space-y-2">
                      <div className="text-sm">
                        <strong>Jou antwoord:</strong> 
                        <span className={isCorrect ? 'text-green-600' : 'text-red-600'}>
                          {Array.isArray(userAnswers[index]) 
                            ? userAnswers[index].join(', ') 
                            : userAnswers[index] || 'Geen antwoord'}
                        </span>
                      </div>
                      {q.sampleAnswer && (
                        <div className="text-sm">
                          <strong>Voorbeeldantwoord:</strong> 
                          <span className="text-green-600">{q.sampleAnswer}</span>
                        </div>
                      )}
                    </div>
                  )}
                </div>
              );
            })}
          </div>

          <div className="flex justify-center space-x-4">
            <button
              onClick={resetPaper}
              className="flex items-center px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors"
            >
              <RotateCcw className="h-5 w-5 mr-2" />
              Probeer Weer
            </button>
            <button
              onClick={() => {
                setCurrentPaper((currentPaper + 1) % practicePapers.length);
                resetPaper();
              }}
              className="flex items-center px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors"
            >
              Volgende Vraestel
              <ChevronRight className="h-5 w-5 ml-2" />
            </button>
          </div>
        </div>
      </div>
    );
  }

  return (
    <div className="max-w-4xl mx-auto p-6 bg-gradient-to-br from-blue-50 to-green-50 min-h-screen">
      <div className="bg-white rounded-lg shadow-lg p-6">
        {/* Header */}
        <div className="mb-6">
          <div className="flex items-center justify-between mb-4">
            <div className="flex items-center">
              <BookOpen className="h-8 w-8 text-blue-600 mr-3" />
              <div>
                <h1 className="text-2xl font-bold text-gray-800">Afrikaans FAL Oefening</h1>
                <p className="text-gray-600">Graad 9 - CAPS Kurrikulum</p>
              </div>
            </div>
            <div className="text-right">
              <p className="text-sm text-gray-600">{paper.title}</p>
              <p className="text-xs text-gray-500">
                Vraag {currentQuestion + 1} van {questions.length}
              </p>
              <p className="text-xs text-blue-600 font-medium">
                Totaal: {totalPossibleMarks} punte
              </p>
            </div>
          </div>
          
          <div className="w-full bg-gray-200 rounded-full h-2">
            <div
              className="bg-blue-600 h-2 rounded-full transition-all duration-300"
              style={{ width: `${((currentQuestion + 1) / questions.length) * 100}%` }}
            ></div>
          </div>
        </div>

        {/* Paper Selection */}
        <div className="mb-6">
          <div className="flex justify-between items-center mb-4">
            <div className="flex space-x-2 overflow-x-auto">
              {practicePapers.map((paperOption, index) => (
                <button
                  key={paperOption.id}
                  onClick={() => {
                    setCurrentPaper(index);
                    resetPaper();
                  }}
                  className={`px-4 py-2 rounded-lg text-sm transition-colors whitespace-nowrap ${
                    currentPaper === index
                      ? 'bg-blue-600 text-white'
                      : 'bg-gray-200 text-gray-700 hover:bg-gray-300'
                  }`}
                >
                  {paperOption.title}
                </button>
              ))}
            </div>
            <button
              onClick={() => setCurrentView('flashcards')}
              className="flex items-center px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors ml-4"
            >
              <Brain className="h-5 w-5 mr-2" />
              Woordeskat
            </button>
          </div>
        </div>

        {/* Comprehension Text (shown for comprehension questions) */}
        {currentQuestion < paper.comprehension.questions.length && (
          <div className="mb-6 p-4 bg-blue-50 rounded-lg border-l-4 border-blue-400">
            <h3 className="font-bold text-lg mb-3 text-blue-800">
              {paper.comprehension.title}
            </h3>
            <div className="text-gray-700 leading-relaxed whitespace-pre-line">
              {paper.comprehension.text}
            </div>
          </div>
        )}

        {/* Current Question */}
        <div className="mb-6">
          <div className="mb-4">
            <div className="flex justify-between items-start mb-2">
              <h3 className="text-lg font-semibold text-gray-800">
                Vraag {currentQuestion + 1}
              </h3>
              <div className="text-right">
                {currentQ.topic && (
                  <span className="px-2 py-1 bg-green-100 text-green-800 text-xs rounded-full block mb-1">
                    {currentQ.topic}
                  </span>
                )}
                <span className="px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full">
                  [{currentQ.marks || 1} {(currentQ.marks || 1) === 1 ? 'punt' : 'punte'}]
                </span>
              </div>
            </div>
            <p className="text-gray-700 text-lg">{currentQ.question}</p>
          </div>

          {renderQuestionInput(currentQ, currentQuestion)}
        </div>

        {/* Navigation */}
        <div className="flex justify-between items-center">
          <button
            onClick={prevQuestion}
            disabled={currentQuestion === 0}
            className={`flex items-center px-4 py-2 rounded-lg transition-colors ${
              currentQuestion === 0
                ? 'bg-gray-200 text-gray-400 cursor-not-allowed'
                : 'bg-gray-300 text-gray-700 hover:bg-gray-400'
            }`}
          >
            <ChevronLeft className="h-5 w-5 mr-1" />
            Vorige
          </button>

          <div className="text-center">
            <div className="text-sm text-gray-600">
              {Object.keys(userAnswers).length} / {questions.length} beantwoord
            </div>
            <div className="text-xs text-blue-600 mt-1">
              Totale punte: {totalPossibleMarks}
            </div>
          </div>

          {currentQuestion === questions.length - 1 ? (
            <button
              onClick={handleSubmit}
              disabled={Object.keys(userAnswers).length !== questions.length}
              className={`px-6 py-2 rounded-lg transition-colors ${
                Object.keys(userAnswers).length === questions.length
                  ? 'bg-green-600 text-white hover:bg-green-700'
                  : 'bg-gray-200 text-gray-400 cursor-not-allowed'
              }`}
            >
              Dien In
            </button>
          ) : (
            <button
              onClick={nextQuestion}
              className="flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors"
            >
              Volgende
              <ChevronRight className="h-5 w-5 ml-1" />
            </button>
          )}
        </div>
      </div>
    </div>
  );
};

export default AfrikaansPracticeApp;